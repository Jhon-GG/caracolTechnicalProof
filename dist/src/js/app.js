import{isValidUrl,isValidEmail,isAudioFile,validateAudioPlayer,validateSocialItems,validateShareItems,validateJsonData,sanitizeText,sanitizeUrl}from"./validation.js";document.addEventListener("DOMContentLoaded",function(){var burgerButton=document.querySelector(".headerBurger");let navMenu=document.querySelector(".navMenu");burgerButton.addEventListener("click",function(){navMenu.classList.toggle("active")});burgerButton=document.getElementById("playButton");let playIcon=document.getElementById("playIcon"),audioPlayer=document.getElementById("audioPlayer");burgerButton.addEventListener("click",()=>{if(audioPlayer.paused){audioPlayer.play();playIcon.src="src/assets/images/audioPause.svg"}else{audioPlayer.pause();playIcon.src="src/assets/images/audioPlayer.svg"}});fetch("src/data/test.json").then(response=>response.json()).then(data=>{var validationResult=validateJsonData(data);validationResult.isValid||console.error("JSON validation errors:",validationResult.errors);validationResult.warnings&&0<validationResult.warnings.length&&console.warn("Validation warnings:",validationResult.warnings);if(validationResult.isValid){loadHeaderLogo(data);loadMainNavigation(data);loadHotTopics(data);loadSocialIcons(data);loadPageLeadImage(data);loadBreadcrumbs(data);loadHeadlineContent(data);loadAudioPlayerData(data);loadShareButtons(data);loadBannerLogo(data)}else showErrorMessage("Errors were found in the data. Check the console for more details.")}).catch(error=>{console.error("Error loading data:",error);showErrorMessage("Error loading data. Please try again later.")})});function showErrorMessage(message){var headlineBox=document.querySelector(".headlineBox");if(headlineBox){var errorDiv=document.createElement("div");errorDiv.className="error-message";errorDiv.style.color="red";errorDiv.style.padding="10px";errorDiv.style.margin="10px 0";errorDiv.style.border="1px solid red";errorDiv.style.borderRadius="5px";errorDiv.textContent=message;headlineBox.appendChild(errorDiv)}}function loadHeaderLogo(data){if(data.logo&&0<data.logo.length){var logoImg=document.getElementById("logo-container"),data=data.logo[0],logoSrc=sanitizeUrl(data.image.src);if(logoSrc){logoImg.src=logoSrc;logoImg.alt=sanitizeText(data.alt);data.image.width&&(logoImg.width=data.image.width);data.image.height&&(logoImg.height=data.image.height)}else console.error("Invalid logo URL:",data.image.src)}}function loadMainNavigation(data){if(data.navigation&&0<data.navigation.length&&data.navigation[0].items){let menuList=document.querySelector(".menuList");menuList.innerHTML="";data.navigation[0].items.forEach(item=>{var validatedHref=sanitizeUrl(item.href);if(validatedHref){var li=document.createElement("li"),a=document.createElement("a");a.href=validatedHref;a.textContent=sanitizeText(item.text);a.classList.add(convertToClassName(item.text));li.appendChild(a);menuList.appendChild(li)}else console.warn("Invalid navigation URL ignored:",item.href)})}}function loadHotTopics(data){if(data.hotTopics&&0<data.hotTopics.length){let trendingBox=document.querySelector(".trendingBox");var trendingSpan=trendingBox.querySelector(".trendingSpan"),br=trendingBox.querySelector("br");trendingBox.innerHTML="";trendingBox.appendChild(trendingSpan);trendingBox.appendChild(br);data.hotTopics.forEach((topic,index)=>{var validatedUrl=sanitizeUrl(topic.url);if(validatedUrl){var a=document.createElement("a");a.href=validatedUrl;a.textContent=sanitizeText(topic.title);a.classList.add("tend"+(index+1));topic.target&&(a.target=sanitizeText(topic.target));trendingBox.appendChild(a)}else console.warn("Invalid trend URL ignored:",topic.url)})}}function loadSocialIcons(data){if(data.social&&0<data.social.length&&data.social[0].items){let socialBox=document.querySelector(".socialBox");socialBox.innerHTML="";var socialValidation=validateSocialItems(data.social[0].items);socialValidation.isValid?data.social[0].items.forEach(item=>{var validatedHref=sanitizeUrl(item.href);if(validatedHref){var a=document.createElement("a"),validatedHref=(a.href=validatedHref,document.createElement("img"));validatedHref.src=`src/assets/images/${sanitizeText(item.socialService)}.svg`;validatedHref.alt=sanitizeText(item.socialService);a.appendChild(validatedHref);socialBox.appendChild(a)}else console.warn("Invalid social URL ignored:",item.href)}):console.error("Errors in social elements:",socialValidation.errors)}}function loadPageLeadImage(data){if(data.pageLead&&0<data.pageLead.length){var pageLeadImg=document.querySelector(".pageLead").querySelector("img"),data=data.pageLead[0],imageSrc=sanitizeUrl(data.image.src);if(imageSrc){pageLeadImg.src=imageSrc;pageLeadImg.alt=sanitizeText(data.alt||"Header image");data.image.width&&(pageLeadImg.width=data.image.width);data.image.height&&(pageLeadImg.height=data.image.height)}else console.error("Invalid header image URL:",data.image.src)}}function loadBreadcrumbs(data){if(data.breadcrumbs&&0<data.breadcrumbs.length){let startBox=document.querySelector(".startBox");startBox.innerHTML="";data.breadcrumbs.forEach((crumb,index)=>{let validatedHref="#";if(crumb.href&&!(validatedHref=sanitizeUrl(crumb.href))&&index<3){console.warn("Invalid breadcrumb URL ignored:",crumb.href);validatedHref="#"}var a=document.createElement("a");a.href=validatedHref;a.textContent=sanitizeText(crumb.body);if(0===index)a.classList.add("startInicio");else if(1===index)a.classList.add("startHumor");else if(2===index){a.classList.add("startSosp");var div=document.createElement("div");div.classList.add("boxSosp");div.appendChild(a);startBox.appendChild(div)}else if(3===index){let div=document.createElement("div");div.classList.add("boxSpan");var p=document.createElement("p");p.classList.add("spanTato");p.textContent=sanitizeText(crumb.body);div.appendChild(p);startBox.appendChild(div)}index<2&&startBox.appendChild(a);if(index<data.breadcrumbs.length-1){div=document.createElement("span");div.textContent=">";startBox.appendChild(div)}})}}function loadHeadlineContent(data){var headlineBox=document.querySelector(".headlineBox");data.headline&&(headlineBox.querySelector("h1").textContent=sanitizeText(data.headline));data.subHeadline&&(headlineBox.querySelector("p").textContent=sanitizeText(data.subHeadline))}function loadAudioPlayerData(data){if(data.audioPlayer&&0<data.audioPlayer.length){var data=data.audioPlayer[0],audioValidation=validateAudioPlayer(data);if(audioValidation.isValid){var audioPlayer=document.getElementById("audioPlayer"),audioTitle=document.querySelector(".audioTitle p");if(data.audioUrl)if(isAudioFile(data.audioUrl)){var audioSource=audioPlayer.querySelector("source"),validatedUrl=sanitizeUrl(data.audioUrl);if(validatedUrl){audioSource.src=validatedUrl;audioPlayer.load()}else console.error("Invalid audio URL:",data.audioUrl)}else console.error("The file is not a recognized audio format:",data.audioUrl);if(data.audioTitle){let durationText="";if(data.audioDuration){audioSource=Math.floor(data.audioDuration/1e3),validatedUrl=Math.floor(audioSource/60);durationText=validatedUrl+":"+(audioSource%60).toString().padStart(2,"0")}audioTitle.innerHTML=sanitizeText(data.audioTitle)+(durationText?` <span>${durationText}</span>`:"")}}else console.error("Errors in audio player:",audioValidation.errors)}}function loadShareButtons(data){if(data.actions&&0<data.actions.length&&data.actions[0].items){let shareIconBox=document.querySelector(".shareIconBox");shareIconBox.innerHTML="";var shareValidation=validateShareItems(data.actions[0].items);shareValidation.isValid?data.actions[0].items.forEach(item=>{if(item._template.includes("Facebook")){var shareHref=sanitizeUrl(item.shareHref);if(shareHref){var a=document.createElement("a"),shareHref=(a.href="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(shareHref),document.createElement("img"));shareHref.src="src/assets/images/facebook2.svg";shareHref.alt="facebook";a.appendChild(shareHref);shareIconBox.appendChild(a)}else console.warn("Invalid Facebook URL ignored:",item.shareHref)}else if(item._template.includes("Twitter")){shareHref=sanitizeUrl(item.url);if(shareHref){let a=document.createElement("a"),img=(a.href=`https://x.com/intent/tweet?text=${encodeURIComponent(sanitizeText(item.text))}&url=`+encodeURIComponent(shareHref),document.createElement("img"));img.src="src/assets/images/twitter2.svg";img.alt="twitter";a.appendChild(img);shareIconBox.appendChild(a)}else console.warn("Invalid Twitter URL ignored:",item.url)}}):console.error("Errors in share items:",shareValidation.errors)}}function loadBannerLogo(data){if(data.logo2&&0<data.logo2.length){var bannerImg=document.querySelector(".bannerBox").querySelector("img"),data=data.logo2[0],logoSrc=sanitizeUrl(data.image.src);if(logoSrc){bannerImg.src=logoSrc;bannerImg.alt=sanitizeText(data.alt||"Banner logo");data.image.width&&(bannerImg.width=data.image.width);data.image.height&&(bannerImg.height=data.image.height)}else console.error("Invalid banner logo URL:",data.image.src)}}function convertToClassName(text){return text.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/\s+/g,"")}